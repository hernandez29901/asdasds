(function(a){var b={css:'',js:'',html:{},height:{},node:''},c={css:!1,js:!1},e,d,g,f;if(a('body').on('click','.woopack-product-quick-view',function(j){var e,f,i,d,h,g;j.preventDefault(),j.stopPropagation(),e=a(this).parents('.fl-module').attr('data-node'),f=a('.fl-node-'+e).find('.woopack-products'),i=a(this).parents('.product'),d=i.data('product-id')||a(this).data('product'),h=a(this).data('template')||!1,g=!0,b.node=a('.fl-node-'+e),'undefined'!=typeof b.html[d]&&(g=!1),f.hasClass('owl-carousel')&&f.trigger('stop.owl.autoplay'),new WooPackModal({source:'ajax',ajaxUrl:woopack_config.ajaxurl,ajaxData:{action:'woopack_product_quick_view',node_id:e,product_id:d,template:h,templateJS:''===b.js,templateCSS:''===b.css},processAjax:g,breakpoint:767,animationSpeed:0,cssClass:'woopack-modal-'+e,responseHandler:function(e,g){var f=g.contentWrap;'undefined'!=typeof b.height[d],''===b.css&&'undefined'!=typeof e.css&&(b.css=e.css),''===b.js&&'undefined'!=typeof e.js&&(b.js=e.js),c.css||(a('head').append(b.css),c.css=!0),'undefined'!=typeof b.html[d]?f.html(b.html[d]):(f.html(e.html),b.html[d]=e.html),h?f.imagesLoaded(function(){c.js?(f.find('.woocommerce-product-gallery').each(function(){a(this).trigger('wc-product-gallery-before-init',[this,wc_single_product_params]),a(this).wc_product_gallery(wc_single_product_params),a(this).trigger('wc-product-gallery-after-init',[this,wc_single_product_params])}),f.find('.wc-tabs-wrapper, .woocommerce-tabs, #rating').trigger('init')):(a('body').append(b.js),c.js=!0),a(b.html[d]).find('.woopack-product').html(f.find('.woopack-product').html()),g._resetHeight(),setTimeout(function(){g.wrapper.addClass('woopack-ajax-loaded')},100)}):setTimeout(function(){g.wrapper.addClass('woopack-ajax-loaded')},100)},onAjaxLoad:function(e){var c=e.wrapper;'undefined'==typeof b.height[d]&&(b.height[d]=c.find('.woopack-modal-inner').outerHeight()),c.find('.woocommerce-product-gallery .woocommerce-product-gallery__image a').on('click',function(c){var b,d;c.preventDefault(),c.stopPropagation(),b=a(this).parents('.woocommerce-product-gallery__image'),d=b.parents('.woocommerce-product-gallery').find('.woocommerce-product-gallery__image:first'),b.insertBefore(d)}),typeof a.fn.wc_variation_form!='undefined'&&c.find('form.variations_form').length>0&&c.find('form.variations_form').wc_variation_form(),c.find('.product-type-external form.cart').attr('target','_blank'),c.find('.woo-variation-gallery-wrapper').length>0&&'undefined'!=typeof jQuery.fn.WooVariationGallery&&c.find('.woo-variation-gallery-wrapper').WooVariationGallery(),c.find('.form.variations_form').length>0&&'undefined'!=typeof jQuery.fn.WooVariationSwatches&&c.find('.woo-variation-items-wrapper').length>0&&c.find('.form.variations_form').WooVariationSwatches(),c.trigger('quick-view-displayed'),a('body').trigger('woopack.quickview.ajaxload',[c])},onClose:function(b){b.removeClass('woopack-modal-'+e),b.removeClass('woopack-ajax-loaded'),b.removeClass('woopack-images-loaded'),a('body').remove('woopack-pswp'),setTimeout(function(){f.hasClass('owl-carousel')&&f.trigger('refresh.owl.carousel')},500)}})}),a(window).on('resize',function(){window.innerWidth>767&&a('.woopack-modal .woopack-modal-inner').css({height:'auto'})}),a(document).on('added_to_cart',function(d,e,f,c){c&&c.length>0&&c.parents('.woopack-modal').length>0&&''!==b.node&&b.node.length>0&&b.node.hasClass('woopack-qv-close-on-add')&&setTimeout(function(){c.parents('.woopack-modal').fadeOut(function(){a(this).find('.woopack-modal-close').trigger('click')})},500)}),a('body').on('change keyup blur','.woopack-products .quantity input.qty',function(){var b=parseInt(a(this).val());b=0===b||''===b?1:b,a(this).val(b),a(this).parents('.woopack-product-action').find('a.button').attr('data-quantity',b)}),'undefined'==typeof wc_add_to_cart_params)return!1;a('body').on('submit','.woopack-modal form.cart, .woopack-single-product form.cart',function(g){var c,h,f,b;if(a(this).hasClass('variations_form')&&typeof a.fn.wc_variation_form=='undefined')return;if(a(this).parents('.product-type-external').length>0)return;g.preventDefault(),g.stopPropagation(),c=a(this),h=a(this).hasClass('grouped_form'),f=a(this).find('button[type="submit"]'),h?a(this).find('.woocommerce-grouped-product-list tr').each(function(){var b=a(this).find('input.qty').val(),e=a(this).attr('id').split('-')[1],c;b>0&&(c={quantity:b,product_id:e},f.removeClass('added'),f.addClass('loading'),a(document.body).trigger('adding_to_cart',[f,c]),d(f,c))}):a(this).find('input[name="variation_id"]').length>0?e(a(this)):(b={action:'woopack_add_to_cart',quantity:a(this).find('.qty').val(),product_id:a(this).find('.single_add_to_cart_button').val()},c.find('.wc-bookings-booking-form').length>0&&(b.product_id=c.find('.wc-booking-product-id').val(),b.wc_bookings_field_start_date_month=c.find('input[name="wc_bookings_field_start_date_month"]').val(),b.wc_bookings_field_start_date_day=c.find('input[name="wc_bookings_field_start_date_day"]').val(),b.wc_bookings_field_start_date_year=c.find('input[name="wc_bookings_field_start_date_year"]').val(),b.wc_bookings_field_start_date_time=c.find('input[name="wc_bookings_field_start_date_time"]').val(),b.wc_bookings_field_start_date_local_timezone=c.find('input[name="wc_bookings_field_start_date_local_timezone"]').val(),b.wc_bookings_field_duration=c.find('input[name="wc_bookings_field_duration"]').val(),b.start_time=c.find('[name="start_time"]').val(),b.end_time=c.find('[name="end_time"]').val()),c.find('.wc-appointment-product-id').length>0&&(b.product_id=c.find('.wc-appointment-product-id').val(),b.wc_appointments_field_start_date_month=c.find('input[name="wc_appointments_field_start_date_month"]').val(),b.wc_appointments_field_start_date_day=c.find('input[name="wc_appointments_field_start_date_day"]').val(),b.wc_appointments_field_start_date_year=c.find('input[name="wc_appointments_field_start_date_year"]').val(),b.wc_appointments_field_start_date_time=c.find('input[name="wc_appointments_field_start_date_time"]').val(),b.wc_appointments_field_start_date_duration=c.find('input[name="wc_appointments_field_start_date_duration"]').val(),b.wc_appointments_field_start_date_cost=c.find('input[name="wc_appointments_field_start_date_cost"]').val()),c.find('input[name="nyp"]').length>0&&(b.nyp=c.find('input[name="nyp"]').val(),b['add-to-cart']=b.product_id),f.removeClass('added'),f.addClass('loading'),a(document.body).trigger('adding_to_cart',[f,b]),d(f,b))}),a('body').on('submit','.woopack-products .product .variations_form, .woopack-product-add-to-cart .variations_form',function(b){if(typeof wc_add_to_cart_params=='undefined')return;b.preventDefault(),b.stopPropagation(),e(a(this))}),a('body').on('submit','.woopack-products .product .grouped_form',function(c){c.preventDefault(),c.stopPropagation();var b=a(this).find('button[type="submit"]');a(this).find('.woocommerce-grouped-product-list tr').each(function(){var c=a(this).find('input.qty').val(),f=a(this).attr('id').split('-')[1],e;c>0&&(e={quantity:c,product_id:f},b.removeClass('added'),b.addClass('loading'),a(document.body).trigger('adding_to_cart',[b,e]),d(b,e))})}),e=function(b){var c={action:'woopack_add_to_cart',quantity:b.find('.qty').val(),product_id:b.find('input[name="product_id"]').val(),variation_id:b.find('input[name="variation_id"]').val()},f=b.data('product_variations')[0],g=[],h=[],i,e;f&&'undefined'!=typeof f.attributes&&(Object.keys(f.attributes).map(function(a){if(b.find('[name="'+a+'"]').length>0){var c=a+'|'+b.find('[name="'+a+'"]').val();g.push(c),h.push(a)}}),c.variation=g),i=b.serializeArray(),i.forEach(function(b,d){'undefined'!=typeof b&&'undefined'==typeof c[b.name]&&'add-to-cart'!==b.name&&-1===a.inArray(b.name,h)&&(c[b.name]=b.value)}),e=b.find('button[type="submit"]'),e.removeClass('added'),e.addClass('loading'),a(document.body).trigger('adding_to_cart',[e,c]),d(e,c)},d=function(d,b){var c=wc_add_to_cart_params.wc_ajax_url.toString().replace('%%endpoint%%','add_to_cart');typeof b.action!='undefined'&&(c=woopack_config.ajaxurl),a.post(c,b,function(b){if(!b)return;if(b.error&&b.product_url){window.location=b.product_url;return}if(wc_add_to_cart_params.cart_redirect_after_add==='yes'){window.location=wc_add_to_cart_params.cart_url;return}a(document.body).trigger('added_to_cart',[b.fragments,b.cart_hash,d])})},a('body').on('change','.woopack-products .product .variations_form select, .woopack-single-product .variations_form select',function(){var b=a(this),d=b.attr('name'),f=b.val(),g=b.parents('.variations_form'),c,e;if(b.parents('.woopack-product-grid.product').length>0?(c=b.parents('.woopack-product-grid.product').find('.woopack-product-image img')):(c=b.parents('.woopack-single-product').find('.single-product-image img')),e=g.data('product_variations'),!e)return;e.forEach(function(a){'undefined'!=typeof a.attributes[d]&&f===a.attributes[d]&&'undefined'!=typeof a.image&&(c.attr('src',a.image.thumb_src),c.attr('srcset',a.image.srcset))})}),a(document).on('wc_cart_button_updated',function(b,a){a&&a.length>0&&a.parent().find('a.added_to_cart').addClass('button alt')}),g=a('.woopack-product-image').find('.woopack-product-featured-image').attr('width'),a('.woopack-product-image').find('.woocommerce-placeholder.wp-post-image').width(g),f=function(){var b,c;a('.woopack-products .woopack-qty-custom').length>0&&a('.woopack-products .woopack-qty-custom .qty-minus').length===0&&(b='<span class="qty-minus"></span>',c='<span class="qty-plus"></span>',a('.woopack-products .woopack-qty-custom input.qty').each(function(){a(this).parent().hasClass('woopack-qty-input')||a(this).parent().addClass('woopack-qty-input'),a(b).insertBefore(a(this)),a(c).insertAfter(a(this));var d=a(this);a(this).parent().find('.qty-minus').on('click',function(){d[0].stepDown(),d.trigger('change')}),a(this).parent().find('.qty-plus').on('click',function(){d[0].stepUp(),d.trigger('change')})}))},f(),a(document).on('woopack.grid.rendered',function(){f()})})(jQuery)